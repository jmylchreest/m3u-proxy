<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Stream Relay - M3U Proxy</title>
        <link rel="stylesheet" href="/static/css/main.css" />
    </head>
    <body>
        <div id="headerContainer"></div>

        <div class="container">
            <div id="navContainer"></div>

            <div id="alertsContainer"></div>

            <!-- Relay Header -->
            <div class="dashboard-header">
                <h1>üéõÔ∏è Stream Relay</h1>
                <p class="text-muted">
                    Optimize stream delivery with FFmpeg-powered relay services
                </p>
            </div>

            <!-- Main Content -->
            <main>

                <!-- System Usage -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">System Usage</h2>
                    </div>
                    <div class="card-content">
                        <div class="row">
                            <div class="col-md-4">
                                <div class="stat-card">
                                    <h4>CPU Load</h4>
                                    <div class="stat-value" id="cpu-usage">
                                        --
                                    </div>
                                    <div class="stat-label">
                                        System average load
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="stat-card">
                                    <h4>Memory Usage</h4>
                                    <div class="stat-value" id="memory-usage">
                                        --
                                    </div>
                                    <div class="stat-label">
                                        Total system memory
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="stat-card">
                                    <h4>Active Processes</h4>
                                    <div
                                        class="stat-value"
                                        id="total-bandwidth"
                                    >
                                        --
                                    </div>
                                    <div class="stat-label">
                                        Running relay processes
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Active Relays -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Active Relays</h2>
                        <button
                            class="btn btn-primary"
                            onclick="refreshRelayStats()"
                        >
                            Refresh Stats
                        </button>
                    </div>
                    <div class="card-content">
                        <div id="active-relays">
                            <div class="loading-state">
                                <p>Loading active relays...</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Relay Profiles -->
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Relay Profiles</h2>
                        <button
                            class="btn btn-success"
                            onclick="showCreateProfileModal()"
                        >
                            Create Profile
                        </button>
                    </div>
                    
                    <!-- Information Section -->
                    <div class="card-body">
                        <details class="info-collapse">
                            <summary class="info-collapse-header">
                                <i class="fas fa-info-circle"></i>
                                <span>Hardware Acceleration & Relay Information</span>
                                <i class="fas fa-chevron-down collapse-icon"></i>
                            </summary>
                            <div class="info-collapse-content">
                                <div class="alert alert-info mb-0">
                                    <div class="d-flex align-items-start">
                                        <i class="fas fa-microchip me-2 mt-1"></i>
                                        <div>
                                            <strong>FFmpeg Hardware Acceleration:</strong>
                                            <div id="hwaccel-status" class="mb-2">
                                                <span class="loading">Loading hardware acceleration status...</span>
                                            </div>
                                            
                                            <div id="hwaccel-details" style="display: none;">
                                                <div class="mb-3">
                                                    <strong>Supported Accelerators & Codecs:</strong>
                                                    <div id="hwaccel-table" class="mt-2">
                                                        <!-- Hardware acceleration table will be populated here -->
                                                    </div>
                                                </div>
                                                
                                                <div class="mb-3">
                                                    <strong>Codec Recommendations:</strong>
                                                    <ul class="mb-2 small">
                                                        <li><strong>H.264:</strong> Most widely supported codec with good compression</li>
                                                        <li><strong>H.265/HEVC:</strong> Better compression than H.264, newer hardware support</li>
                                                        <li><strong>AV1:</strong> Newest codec with excellent compression, limited hardware support</li>
                                                    </ul>
                                                </div>
                                                
                                                <div class="mb-3">
                                                    <strong>How Relay Works:</strong>
                                                    <ul class="mb-2 small">
                                                        <li><strong>Input:</strong> Transport stream from the original source URL</li>
                                                        <li><strong>Processing:</strong> FFmpeg transcodes using hardware acceleration</li>
                                                        <li><strong>Output:</strong> HLS segments in sandboxed temporary storage</li>
                                                        <li><strong>Serving:</strong> Stream API serves the transcoded content to clients</li>
                                                    </ul>
                                                </div>
                                                
                                                <div class="mb-0">
                                                    <strong>Example Relay Profile Commands:</strong>
                                                    <small class="d-block mb-2 text-muted">
                                                        These are template commands used in relay profiles. 
                                                        {input_url} and {output_path} are replaced at runtime.
                                                    </small>
                                                    <div id="hwaccel-examples" class="mt-2">
                                                        <!-- Example commands will be populated here -->
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </details>
                    </div>
                    <div class="card-content">
                        <div id="relay-profiles">
                            <div class="loading-state">
                                <p>Loading relay profiles...</p>
                            </div>
                        </div>
                    </div>
                </div>

            </main>

            <!-- Footer -->
            <div id="footer-placeholder"></div>
        </div>

        <!-- Profile Modal -->
        <div id="profileModal" class="modal">
            <div class="modal-content standard-modal">
                <div class="modal-header">
                    <h3 id="modalTitle">Create Relay Profile</h3>
                </div>
                <div class="modal-body">
                    <!-- System Default Notice -->
                    <div id="systemDefaultNotice" class="alert alert-info" style="display: none;">
                        <i class="fas fa-info-circle"></i>
                        <strong>System Default Profile</strong> - This profile cannot be modified or deleted.
                    </div>

                    <!-- Basic Information -->
                    <div class="form-section">
                        <h4>Basic Information</h4>
                        <div class="form-group">
                            <label for="profileName" class="form-label">Profile Name *</label>
                            <input
                                type="text"
                                id="profileName"
                                class="form-control"
                                placeholder="e.g., HD H.264 Transcode"
                                required
                            />
                        </div>

                        <div class="form-group">
                            <label for="profileDescription" class="form-label">Description</label>
                            <input
                                type="text"
                                id="profileDescription"
                                class="form-control"
                                placeholder="Profile description"
                            />
                        </div>
                    </div>

                    <!-- Video Settings -->
                    <div class="form-section">
                        <h4>Video Settings</h4>
                        <div class="form-row">
                            <div class="form-group col-md-6">
                                <label for="videoCodec" class="form-label">Video Codec *</label>
                                <select id="videoCodec" class="form-control" required>
                                    <option value="h264">H.264</option>
                                    <option value="h265">H.265/HEVC</option>
                                    <option value="av1">AV1</option>
                                    <option value="mpeg2">MPEG-2</option>
                                    <option value="mpeg4">MPEG-4</option>
                                    <option value="copy">Copy (no re-encode)</option>
                                </select>
                            </div>
                            <div class="form-group col-md-6">
                                <label for="videoProfile" class="form-label">Video Profile</label>
                                <select id="videoProfile" class="form-control">
                                    <option value="">Auto</option>
                                    <option value="main">Main</option>
                                    <option value="main10">Main10</option>
                                    <option value="high">High</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group col-md-4">
                                <label for="videoPreset" class="form-label">Video Preset</label>
                                <select id="videoPreset" class="form-control">
                                    <option value="">Auto</option>
                                    <option value="slow">Slow (better quality)</option>
                                    <option value="medium">Medium</option>
                                    <option value="fast">Fast (lower CPU)</option>
                                    <option value="ultrafast">Ultra Fast</option>
                                </select>
                            </div>
                            <div class="form-group col-md-4">
                                <label for="videoBitrate" class="form-label">Video Bitrate (kbps)</label>
                                <input
                                    type="number"
                                    id="videoBitrate"
                                    class="form-control"
                                    placeholder="e.g., 2000"
                                    min="100"
                                    max="50000"
                                />
                            </div>
                        </div>
                    </div>

                    <!-- Audio Settings -->
                    <div class="form-section">
                        <h4>Audio Settings</h4>
                        <div class="form-row">
                            <div class="form-group col-md-6">
                                <label for="audioCodec" class="form-label">Audio Codec *</label>
                                <select id="audioCodec" class="form-control" required>
                                    <option value="aac">AAC</option>
                                    <option value="mp3">MP3</option>
                                    <option value="ac3">AC3 (Dolby Digital)</option>
                                    <option value="eac3">E-AC3 (Enhanced AC3)</option>
                                    <option value="mpeg2audio">MPEG-2 Audio</option>
                                    <option value="dts">DTS</option>
                                    <option value="copy">Copy (no re-encode)</option>
                                </select>
                            </div>
                            <div class="form-group col-md-6">
                                <label for="audioBitrate" class="form-label">Audio Bitrate (kbps)</label>
                                <input
                                    type="number"
                                    id="audioBitrate"
                                    class="form-control"
                                    placeholder="e.g., 128"
                                    min="32"
                                    max="512"
                                />
                            </div>
                        </div>
                    </div>

                    <!-- Hardware Acceleration -->
                    <div class="form-section">
                        <h4>Hardware Acceleration</h4>
                        <div class="form-group">
                            <div class="form-check">
                                <input
                                    type="checkbox"
                                    id="enableHardwareAcceleration"
                                    class="form-check-input"
                                />
                                <label for="enableHardwareAcceleration" class="form-check-label">
                                    Enable Hardware Acceleration
                                </label>
                            </div>
                            <small class="text-muted">
                                Automatically use hardware encoders when available (VAAPI, NVENC, QSV, AMF)
                            </small>
                        </div>

                        <div class="form-group">
                            <label for="preferredHwaccel" class="form-label">Preferred Hardware Accelerator</label>
                            <select id="preferredHwaccel" class="form-control">
                                <option value="auto">Auto (detect best)</option>
                                <option value="vaapi">VAAPI (Intel/AMD)</option>
                                <option value="nvenc">NVENC (NVIDIA)</option>
                                <option value="qsv">QSV (Intel Quick Sync)</option>
                                <option value="amf">AMF (AMD)</option>
                            </select>
                        </div>
                    </div>

                    <!-- Manual Arguments Override -->
                    <div class="form-section">
                        <h4>Manual Arguments Override</h4>
                        <div class="form-group">
                            <label for="manualArgs" class="form-label">Manual FFmpeg Arguments</label>
                            <textarea
                                id="manualArgs"
                                class="form-control"
                                rows="3"
                                placeholder="Optional: Override all automatic settings with custom FFmpeg command"
                            ></textarea>
                            <small class="text-muted">
                                If provided, this will override all automatic codec and hardware acceleration settings above.
                                Use {input_url} and {output_path} placeholders.
                            </small>
                        </div>
                    </div>

                    <!-- Output Settings -->
                    <div class="form-section">
                        <h4>Output Settings</h4>
                        <div class="form-row">
                            <div class="form-group col-md-4">
                                <label for="outputFormat" class="form-label">Output Format *</label>
                                <select id="outputFormat" class="form-control" required>
                                    <option value="transport_stream">Transport Stream</option>
                                    <option value="hls">HLS</option>
                                    <option value="dash">DASH</option>
                                </select>
                            </div>
                            <div class="form-group col-md-4">
                                <label for="segmentDuration" class="form-label">Segment Duration (seconds)</label>
                                <input
                                    type="number"
                                    id="segmentDuration"
                                    class="form-control"
                                    value="30"
                                    min="1"
                                    max="60"
                                />
                            </div>
                            <div class="form-group col-md-4">
                                <label for="maxSegments" class="form-label">Max Segments</label>
                                <input
                                    type="number"
                                    id="maxSegments"
                                    class="form-control"
                                    value="10"
                                    min="1"
                                    max="100"
                                />
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="inputTimeout" class="form-label">Input Timeout (seconds)</label>
                            <input
                                type="number"
                                id="inputTimeout"
                                class="form-control"
                                value="30"
                                min="5"
                                max="300"
                            />
                        </div>
                    </div>

                    <!-- FFmpeg Command Preview -->
                    <div class="form-section">
                        <h4>FFmpeg Command Preview</h4>
                        <div class="command-preview-container">
                            <div class="command-preview-header">
                                <strong>Generated FFmpeg Command:</strong>
                            </div>
                            <div class="command-preview" id="ffmpegPreview">
                                <pre><code>Loading command preview...</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button
                        type="button"
                        class="btn btn-primary"
                        id="saveProfileButton"
                        onclick="createProfile()"
                    >
                        Create Profile
                    </button>
                    <button
                        type="button"
                        class="btn btn-secondary"
                        onclick="hideProfileModal()"
                    >
                        Cancel
                    </button>
                </div>
            </div>
        </div>



        <style>
            .row {
                display: flex;
                gap: 1rem;
                margin: -0.5rem;
            }

            .col-md-4 {
                flex: 1;
                padding: 0.5rem;
            }

            .stat-card {
                background: #f8f9fa;
                padding: 1.5rem;
                border-radius: 8px;
                text-align: center;
                border: 1px solid #e9ecef;
            }

            .stat-card h4 {
                margin: 0 0 1rem 0;
                color: #495057;
                font-size: 0.9rem;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }

            .stat-value {
                font-size: 2rem;
                font-weight: bold;
                color: #ff6b6b;
                margin-bottom: 0.5rem;
            }

            .stat-label {
                font-size: 0.8rem;
                color: #6c757d;
            }

            .empty-state {
                text-align: center;
                padding: 3rem 1rem;
                color: #6c757d;
            }

            .empty-state h3 {
                margin-bottom: 1rem;
                color: #495057;
            }

            .empty-state p {
                margin-bottom: 1.5rem;
            }

            .card-content ul,
            .card-content ol {
                margin: 1rem 0;
                padding-left: 2rem;
            }

            .card-content li {
                margin-bottom: 0.5rem;
            }

            .card-content h3 {
                margin: 1.5rem 0 1rem 0;
                color: #495057;
            }

            .alert {
                background: #e7f3ff;
                border: 1px solid #b8daff;
                border-radius: 8px;
                padding: 1.5rem;
                margin: 1.5rem 0;
                border-left: 4px solid #007bff;
            }

            .alert-info {
                background: #f0f8ff;
                border-color: #bee5eb;
                border-left-color: #17a2b8;
            }

            .alert h4 {
                margin: 0 0 1rem 0;
                color: #004085;
                font-size: 1.1rem;
            }

            .alert h5 {
                margin: 1.5rem 0 0.5rem 0;
                color: #155724;
                font-size: 1rem;
                font-weight: 600;
            }

            .alert h6 {
                margin: 1rem 0 0.5rem 0;
                color: #495057;
                font-size: 0.9rem;
                font-weight: 600;
            }

            .alert p {
                margin: 0.5rem 0;
                line-height: 1.6;
            }

            .alert ul,
            .alert ol {
                margin: 0.5rem 0;
                padding-left: 2rem;
            }

            .alert li {
                margin-bottom: 0.5rem;
            }

            .important-note {
                background: #fff3cd;
                border: 1px solid #ffeaa7;
                border-left: 4px solid #ffc107;
                padding: 1rem;
                margin: 1rem 0;
                border-radius: 4px;
                font-weight: 500;
            }

            .code-examples {
                background: #f8f9fa;
                border: 1px solid #e9ecef;
                border-radius: 4px;
                padding: 1rem;
                margin: 1rem 0;
            }

            .code-examples p {
                margin: 1rem 0 0.5rem 0;
                font-weight: 600;
                color: #495057;
            }

            .code-examples code {
                display: block;
                background: #2d3748;
                color: #e2e8f0;
                padding: 0.75rem;
                border-radius: 4px;
                font-family: "Monaco", "Menlo", "Ubuntu Mono", monospace;
                font-size: 0.85rem;
                line-height: 1.4;
                overflow-x: auto;
                margin-bottom: 1rem;
                white-space: pre-wrap;
                word-break: break-all;
            }

            .loading-state {
                text-align: center;
                padding: 2rem;
                color: #6c757d;
                font-style: italic;
            }

            @media (max-width: 768px) {
                .row {
                    flex-direction: column;
                }

                .col-md-4 {
                    flex: none;
                }

                .code-examples code {
                    font-size: 0.75rem;
                    padding: 0.5rem;
                }

                .alert {
                    padding: 1rem;
                }
            }

            /* Information Collapse Styles */
            .info-collapse {
                border: 1px solid #dee2e6;
                border-radius: 0.375rem;
                margin-bottom: 1rem;
            }

            .info-collapse-header {
                display: flex;
                align-items: center;
                gap: 0.5rem;
                padding: 0.75rem 1rem;
                cursor: pointer;
                background-color: #f8f9fa;
                border-radius: 0.375rem;
                user-select: none;
                font-weight: 500;
                transition: background-color 0.2s;
            }

            .info-collapse-header:hover {
                background-color: #e9ecef;
            }

            .info-collapse .collapse-icon {
                margin-left: auto;
                transition: transform 0.2s;
            }

            details[open] .collapse-icon {
                transform: rotate(180deg);
            }

            .info-collapse-content {
                padding: 1rem;
                border-top: 1px solid #dee2e6;
            }

            /* Hardware acceleration table styles */
            .hwaccel-table {
                display: table;
                width: 100%;
                border-collapse: separate;
                border-spacing: 0;
                border: 1px solid #dee2e6;
                border-radius: 0.375rem;
                font-size: 0.875rem;
                margin-bottom: 1rem;
            }

            .hwaccel-table .table-header {
                display: table-header-group;
                background-color: #f8f9fa;
                font-weight: 600;
            }

            .hwaccel-table .table-row {
                display: table-row;
            }

            .hwaccel-table .table-cell {
                display: table-cell;
                padding: 0.5rem;
                border-bottom: 1px solid #dee2e6;
                vertical-align: middle;
            }

            .hwaccel-table .table-header .table-cell {
                border-bottom: 2px solid #dee2e6;
            }

            .hwaccel-table .table-row:last-child .table-cell {
                border-bottom: none;
            }

            .hwaccel-available {
                color: #28a745;
                font-weight: 500;
            }

            .hwaccel-unavailable {
                color: #6c757d;
                font-style: italic;
            }

            .hwaccel-example {
                background-color: #f8f9fa;
                border: 1px solid #dee2e6;
                border-radius: 0.375rem;
                padding: 0.75rem;
                margin-bottom: 0.5rem;
                font-family: 'Courier New', monospace;
                font-size: 0.875rem;
                overflow-x: auto;
            }

            .hwaccel-example .example-title {
                font-weight: 600;
                margin-bottom: 0.5rem;
                font-family: system-ui, -apple-system, sans-serif;
            }

            .hwaccel-example code {
                background: none;
                padding: 0;
                font-size: inherit;
                word-break: break-all;
            }

            /* Profile Modal Styles */
            .form-section {
                margin-bottom: 2rem;
                padding-bottom: 1.5rem;
                border-bottom: 1px solid #dee2e6;
            }

            .form-section:last-child {
                border-bottom: none;
            }

            .form-section h4 {
                margin-bottom: 1rem;
                color: #495057;
                font-size: 1.1rem;
                font-weight: 600;
            }

            .form-row {
                display: flex;
                gap: 1rem;
                margin-bottom: 1rem;
            }

            .form-row .form-group {
                flex: 1;
                margin-bottom: 0;
            }

            .form-group.col-md-4 {
                flex: 0 0 calc(33.333% - 0.75rem);
            }

            .form-group.col-md-6 {
                flex: 0 0 calc(50% - 0.5rem);
            }

            .form-label {
                font-weight: 500;
                margin-bottom: 0.5rem;
                color: #495057;
            }

            .text-muted {
                color: #6c757d !important;
                font-size: 0.875rem;
            }

            /* Command Preview Styles */
            .command-preview-container {
                margin-top: 1rem;
                padding-top: 1rem;
                border-top: 1px solid #dee2e6;
            }

            .command-preview-header {
                margin-bottom: 0.5rem;
                font-weight: 600;
                color: #495057;
            }

            .command-preview {
                background: #f8f9fa;
                border: 1px solid #dee2e6;
                border-radius: 0.375rem;
                padding: 1rem;
                font-family: 'Courier New', Courier, monospace;
                font-size: 0.875rem;
                line-height: 1.5;
                max-height: 300px;
                overflow-y: auto;
            }

            .command-preview pre {
                margin: 0;
                white-space: pre-wrap;
                word-break: break-all;
            }

            .command-preview code {
                background: none;
                padding: 0;
                font-size: inherit;
                color: #495057;
            }

            /* Responsive adjustments */
            @media (max-width: 768px) {
                .form-row {
                    flex-direction: column;
                    gap: 0;
                }

                .form-group.col-md-4,
                .form-group.col-md-6 {
                    flex: 1;
                }
            }

            /* Profile card enhancements */
            .profile-card {
                border: 1px solid #dee2e6;
                border-radius: 0.375rem;
                background: white;
                margin-bottom: 1rem;
                transition: box-shadow 0.15s ease-in-out;
            }

            .profile-card:hover {
                box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
            }

            .profile-header {
                display: flex;
                justify-content: space-between;
                align-items: flex-start;
                padding: 1rem 1rem 0.5rem;
                border-bottom: 1px solid #f1f3f4;
            }

            .profile-header h4 {
                margin: 0;
                font-size: 1.1rem;
                font-weight: 600;
                color: #495057;
            }

            .profile-badges {
                display: flex;
                gap: 0.5rem;
                flex-wrap: wrap;
            }

            .badge {
                padding: 0.25rem 0.5rem;
                font-size: 0.75rem;
                font-weight: 500;
                border-radius: 0.25rem;
                white-space: nowrap;
            }

            .badge-info {
                background-color: #d1ecf1;
                color: #0c5460;
            }

            .badge-success {
                background-color: #d4edda;
                color: #155724;
            }

            .badge-primary {
                background-color: #d1ecf1;
                color: #0c5460;
            }

            .badge-warning {
                background-color: #fff3cd;
                color: #856404;
            }

            .profile-body {
                padding: 1rem;
            }

            .profile-description {
                margin-bottom: 1rem;
                color: #6c757d;
                font-size: 0.9rem;
            }

            .profile-details {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 0.75rem;
                margin-bottom: 1rem;
            }

            .detail-item {
                display: flex;
                flex-direction: column;
                gap: 0.25rem;
            }

            .detail-item label {
                font-weight: 500;
                font-size: 0.8rem;
                color: #6c757d;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }

            .detail-item span {
                font-size: 0.9rem;
                color: #495057;
            }

            .profile-actions {
                display: flex;
                gap: 0.5rem;
                padding-top: 0.75rem;
                border-top: 1px solid #f1f3f4;
            }

            .relay-graphs {
                margin-top: 1.5rem;
                padding-top: 1rem;
                border-top: 1px solid #dee2e6;
                display: flex;
                gap: 1rem;
                flex-wrap: wrap;
            }

            .graph-section {
                flex: 1;
                min-width: 250px;
                margin-bottom: 0;
            }

            .graph-section h5 {
                margin-bottom: 0.5rem;
                color: #495057;
                font-size: 0.8rem;
                font-weight: 600;
                text-align: center;
            }


            @media (max-width: 768px) {
                .relay-graphs {
                    flex-direction: column;
                }
                
                .graph-section {
                    min-width: unset;
                }
            }

            .relay-card {
                margin-bottom: 2rem;
                border: 1px solid #dee2e6;
                border-radius: 0.5rem;
                background: white;
                box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
            }

            .relay-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 1rem;
                border-bottom: 1px solid #dee2e6;
                background: #f8f9fa;
                border-radius: 0.5rem 0.5rem 0 0;
            }

            .relay-header h4 {
                margin: 0;
                color: #495057;
                font-size: 1.1rem;
            }

            .relay-status {
                display: flex;
                align-items: center;
                gap: 0.5rem;
            }

            .status-indicator {
                width: 12px;
                height: 12px;
                border-radius: 50%;
                background: #dc3545;
            }

            .status-indicator.running {
                background: #28a745;
                animation: pulse 2s infinite;
            }

            @keyframes pulse {
                0% { opacity: 1; }
                50% { opacity: 0.5; }
                100% { opacity: 1; }
            }

            .status-text {
                font-weight: 500;
                color: #495057;
            }

            .relay-body {
                padding: 1rem;
            }

            .relay-stats {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 1rem;
                margin-bottom: 1rem;
            }

            .stat-item {
                display: flex;
                flex-direction: column;
                gap: 0.25rem;
            }

            .stat-item label {
                font-size: 0.8rem;
                color: #6c757d;
                font-weight: 500;
                text-transform: uppercase;
                letter-spacing: 0.5px;
            }

            .stat-item span {
                font-size: 0.95rem;
                color: #495057;
                font-weight: 500;
            }

            .stat-item .highlight {
                color: #007bff;
                font-weight: 600;
            }

            .stat-item .monospace {
                font-family: 'Courier New', Courier, monospace;
                font-size: 0.85rem;
                background: #f8f9fa;
                padding: 0.25rem 0.5rem;
                border-radius: 0.25rem;
                border: 1px solid #e9ecef;
            }
        </style>

        <script>
            // Load shared components
            async function loadSharedComponents() {
                try {
                    console.log("Loading shared components...");
                    const headerResponse = await fetch("/static/html/shared/header.html");
                    if (headerResponse.ok) {
                        document.getElementById("headerContainer").innerHTML = await headerResponse.text();
                        console.log("Header loaded successfully");
                    }

                    const navResponse = await fetch("/static/html/shared/nav.html");
                    if (navResponse.ok) {
                        document.getElementById("navContainer").innerHTML = await navResponse.text();
                        console.log("Nav loaded successfully");
                    }

                    const footerResponse = await fetch("/static/html/shared/footer-basic.html");
                    if (footerResponse.ok) {
                        document.getElementById("footer-placeholder").innerHTML = await footerResponse.text();
                        console.log("Footer loaded successfully");
                    }
                } catch (error) {
                    console.error("Error loading shared components:", error);
                }
            }

            // Load components when page loads
            document.addEventListener("DOMContentLoaded", function() {
                console.log("DOM content loaded, starting component loading...");
                loadSharedComponents();
            });
        </script>
        <script src="/static/js/shared-utils.js"></script>
        <script src="/static/js/shared-loader.js"></script>
        <script src="/static/js/relay.js"></script>
        <link rel="stylesheet" href="/static/css/relay.css" />
    </body>
</html>
