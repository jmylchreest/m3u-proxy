# M3U Proxy Configuration
# Copy this file to .env and modify the values as needed

# Most critical options here first:
# -----------------------------------------------------------------

# PostgreSQL Database Configuration
POSTGRES_DB=m3u_proxy
POSTGRES_USER=m3u_proxy
POSTGRES_PASSWORD=secure_password_change_me

# M3U Proxy
M3U_PROXY_WEB__BASE_URL=http://localhost:8080
M3U_PROXY_DATABASE__URL=postgresql://m3u_proxy:secure_password_change_me@postgres:5432/m3u_proxy
M3U_PROXY_CONFIG=/app/config/config.toml

# Optional:
# -----------------------------------------------------------------

# PostgreSQL
POSTGRES_INITDB_ARGS=--encoding=UTF8 --locale=C
POSTGRES_PORT=5432

# M3U Proxy Application Configuration
# M3U_PROXY_HOST=0.0.0.0
# M3U_PROXY_PORT=8080

# Database Connection
# M3U_PROXY_DATABASE__MAX_CONNECTIONS=10

# Database Batch Sizes (optional)
# M3U_PROXY_DATABASE__BATCH_SIZES__EPG_PROGRAMS=2000
# M3U_PROXY_DATABASE__BATCH_SIZES__STREAM_CHANNELS=1000

# SQLite Configuration (if using SQLite instead of PostgreSQL)
# M3U_PROXY_DATABASE__SQLITE__BUSY_TIMEOUT=5000
# M3U_PROXY_DATABASE__SQLITE__CACHE_SIZE=-64000
# M3U_PROXY_DATABASE__SQLITE__WAL_AUTOCHECKPOINT=1000
# M3U_PROXY_DATABASE__SQLITE__JOURNAL_MODE=WAL
# M3U_PROXY_DATABASE__SQLITE__SYNCHRONOUS=NORMAL

# PostgreSQL Configuration
# M3U_PROXY_DATABASE__POSTGRESQL__STATEMENT_TIMEOUT=30s
# M3U_PROXY_DATABASE__POSTGRESQL__IDLE_TIMEOUT=10m
# M3U_PROXY_DATABASE__POSTGRESQL__MAX_LIFETIME=30m

# Web Server Configuration
# M3U_PROXY_WEB__HOST=0.0.0.0
# M3U_PROXY_WEB__PORT=8080
# M3U_PROXY_WEB__REQUEST_TIMEOUT=30s
# M3U_PROXY_WEB__MAX_REQUEST_SIZE=10MB
# M3U_PROXY_WEB__ENABLE_REQUEST_LOGGING=false
# M3U_PROXY_WEB__USER_AGENT=m3u-proxy/1.0.0

# Storage Paths
# M3U_PROXY_STORAGE__M3U_PATH=/app/data/m3u
# M3U_PROXY_STORAGE__M3U_RETENTION=30d
# M3U_PROXY_STORAGE__M3U_CLEANUP_INTERVAL=4h

# M3U_PROXY_STORAGE__UPLOADED_LOGO_PATH=/app/data/logos/uploaded

# M3U_PROXY_STORAGE__CACHED_LOGO_PATH=/app/data/logos/cached
# M3U_PROXY_STORAGE__CACHED_LOGO_RETENTION=90d
# M3U_PROXY_STORAGE__CACHED_LOGO_CLEANUP_INTERVAL=12h

# M3U_PROXY_STORAGE__TEMP_PATH=/app/data/temp
# M3U_PROXY_STORAGE__TEMP_RETENTION=5m
# M3U_PROXY_STORAGE__TEMP_CLEANUP_INTERVAL=1m

# M3U_PROXY_STORAGE__PIPELINE_PATH=/app/data/pipeline
# M3U_PROXY_STORAGE__PIPELINE_RETENTION=10m
# M3U_PROXY_STORAGE__PIPELINE_CLEANUP_INTERVAL=2m

# Ingestion Configuration
# M3U_PROXY_INGESTION__PROGRESS_UPDATE_INTERVAL=1000
# M3U_PROXY_INGESTION__RUN_MISSED_IMMEDIATELY=true
# M3U_PROXY_INGESTION__USE_NEW_SOURCE_HANDLERS=true

# Data Mapping Engine Configuration
# M3U_PROXY_DATA_MAPPING_ENGINE__PRECHECK_SPECIAL_CHARS=+-@#$%&*=<>!~`€£{}[].
# M3U_PROXY_DATA_MAPPING_ENGINE__MINIMUM_LITERAL_LENGTH=2

# Relay/FFmpeg Configuration
# M3U_PROXY_RELAY__FFMPEG_COMMAND=ffmpeg
# M3U_PROXY_RELAY__FFPROBE_COMMAND=ffprobe
# M3U_PROXY_RELAY__ANALYZEDURATION=10s
# M3U_PROXY_RELAY__PROBESIZE=10MB

# Buffer Configuration
# M3U_PROXY_RELAY__BUFFER__MAX_BUFFER_SIZE=52428800
# M3U_PROXY_RELAY__BUFFER__MAX_CHUNKS=1000
# M3U_PROXY_RELAY__BUFFER__CHUNK_TIMEOUT_SECONDS=60
# M3U_PROXY_RELAY__BUFFER__CLIENT_TIMEOUT_SECONDS=30
# M3U_PROXY_RELAY__BUFFER__CLEANUP_INTERVAL_SECONDS=5
# M3U_PROXY_RELAY__BUFFER__ENABLE_FILE_SPILL=false
# M3U_PROXY_RELAY__BUFFER__MAX_FILE_SPILL_SIZE=524288000

# Security Configuration
# M3U_PROXY_SECURITY__MAX_QUANTIFIER_LIMIT=100

# Circuit Breaker Configuration
# M3U_PROXY_CIRCUITBREAKER__GLOBAL__IMPLEMENTATION_TYPE=simple
# M3U_PROXY_CIRCUITBREAKER__GLOBAL__FAILURE_THRESHOLD=3
# M3U_PROXY_CIRCUITBREAKER__GLOBAL__OPERATION_TIMEOUT=5s
# M3U_PROXY_CIRCUITBREAKER__GLOBAL__RESET_TIMEOUT=30s
# M3U_PROXY_CIRCUITBREAKER__GLOBAL__SUCCESS_THRESHOLD=2
# M3U_PROXY_CIRCUITBREAKER__GLOBAL__ACCEPTABLE_STATUS_CODES=2xx,3xx

# Feature Flags (optional examples)
# M3U_PROXY_FEATURES__FLAGS__DEBUG_FRONTEND=false
# M3U_PROXY_FEATURES__FLAGS__EXPERIMENTAL_UI=false

# Feature Configuration (optional examples)
# M3U_PROXY_FEATURES__CONFIG__DEBUG_FRONTEND__LEVEL=verbose
# M3U_PROXY_FEATURES__CONFIG__VIDEO_PLAYER__BUFFER_SIZE=1024

# Logging Level (set via standard environment variable)
# RUST_LOG=info

# OpenTelemetry Configuration
# -----------------------------------------------------------------
# Enable OpenTelemetry by setting the OTLP endpoint
# When using docker-compose with --profile observability, use: http://otel-collector:4317
# For local development without observability stack, comment out this line to disable OTLP
# OTEL_EXPORTER_OTLP_ENDPOINT=http://otel-collector:4317

# Additional OpenTelemetry settings (optional)
# OTEL_SERVICE_NAME=m3u-proxy
# OTEL_SERVICE_VERSION=0.2.3
# OTEL_RESOURCE_ATTRIBUTES=service.name=m3u-proxy,service.version=0.2.3

# Grafana Stack Configuration (for docker-compose observability profile)
# -----------------------------------------------------------------
# Default admin credentials for Grafana dashboard
# GRAFANA_ADMIN_USER=admin
# GRAFANA_ADMIN_PASSWORD=admin
